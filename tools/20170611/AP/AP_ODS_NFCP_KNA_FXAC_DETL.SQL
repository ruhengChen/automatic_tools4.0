SELECT 'Rows updated:',COUNT(1) FROM (SELECT 1 FROM DELTA.NFCP_KNA_FXAC_DETL WHERE ETL_FLAG IN ('A','D','I')) S;

----重跑：删除已跑入数据
DELETE FROM NFCP.KNA_FXAC_DETL WHERE JOB_SEQ_ID= New_JOB_SEQ_ID;
--加链
INSERT INTO NFCP.KNA_FXAC_DETL(CORPNO,ACCTNO,DETLSQ,CRCYCD,CSEXTG,OPENDT,OPENSQ,CLOSDT,CLOSSQ,BGINDT,MATUDT,ONLNBL,LSTRDT,LSTRSQ,ACCTST,TIMETM,EFF_DT,END_DT,JOB_SEQ_ID)
select CORPNO,ACCTNO,DETLSQ,CRCYCD,CSEXTG,OPENDT,OPENSQ,CLOSDT,CLOSSQ,BGINDT,MATUDT,ONLNBL,LSTRDT,LSTRSQ,ACCTST,TIMETM,'#DATEOFDATA#','#DATEOFDATA#',New_JOB_SEQ_ID
from DELTA.NFCP_KNA_FXAC_DETL where ETL_FLAG in ('D');

--加链
INSERT INTO NFCP.KNA_FXAC_DETL(CORPNO,ACCTNO,DETLSQ,CRCYCD,CSEXTG,OPENDT,OPENSQ,CLOSDT,CLOSSQ,BGINDT,MATUDT,ONLNBL,LSTRDT,LSTRSQ,ACCTST,TIMETM,EFF_DT,END_DT,JOB_SEQ_ID)
select CORPNO,ACCTNO,DETLSQ,CRCYCD,CSEXTG,OPENDT,OPENSQ,CLOSDT,CLOSSQ,BGINDT,MATUDT,ONLNBL,LSTRDT,LSTRSQ,ACCTST,TIMETM,'#DATEOFDATA#','9999-12-31',New_JOB_SEQ_ID
from DELTA.NFCP_KNA_FXAC_DETL where ETL_FLAG in ('A','I');

