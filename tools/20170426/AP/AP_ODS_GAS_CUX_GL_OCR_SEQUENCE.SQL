SELECT 'Rows updated:',COUNT(1) FROM (SELECT 1 FROM DELTA.GAS_CUX_GL_OCR_SEQUENCE WHERE ETL_FLAG IN ('A','D','I')) S;

----重跑：删除已跑入数据
DELETE FROM GAS.CUX_GL_OCR_SEQUENCE WHERE JOB_SEQ_ID= New_JOB_SEQ_ID;
--加链
INSERT INTO GAS.CUX_GL_OCR_SEQUENCE(SEQUENCE_NUM,TRX_DATE,ORG_NUM,USER_NUM,ORIGINAL_TRX_CODE,CHECK_USER_NUM,APPROVE_FLAG,CORE_SEQUENCE_NUM,EFF_DT,END_DT,JOB_SEQ_ID)
select SEQUENCE_NUM,TRX_DATE,ORG_NUM,USER_NUM,ORIGINAL_TRX_CODE,CHECK_USER_NUM,APPROVE_FLAG,CORE_SEQUENCE_NUM,'#DATEOFDATA#','#DATEOFDATA#',New_JOB_SEQ_ID
from DELTA.GAS_CUX_GL_OCR_SEQUENCE where ETL_FLAG in ('D');

--加链
INSERT INTO GAS.CUX_GL_OCR_SEQUENCE(SEQUENCE_NUM,TRX_DATE,ORG_NUM,USER_NUM,ORIGINAL_TRX_CODE,CHECK_USER_NUM,APPROVE_FLAG,CORE_SEQUENCE_NUM,EFF_DT,END_DT,JOB_SEQ_ID)
select SEQUENCE_NUM,TRX_DATE,ORG_NUM,USER_NUM,ORIGINAL_TRX_CODE,CHECK_USER_NUM,APPROVE_FLAG,CORE_SEQUENCE_NUM,'#DATEOFDATA#','9999-12-31',New_JOB_SEQ_ID
from DELTA.GAS_CUX_GL_OCR_SEQUENCE where ETL_FLAG in ('A','I');

